{"version":3,"sources":["webpack:///./src/views/Rank.vue?3072","webpack:///./src/views/Rank.vue?2172","webpack:///src/views/Rank.vue","webpack:///./src/views/Rank.vue?25e1","webpack:///./src/views/Rank.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","handleSubmit","_v","ref","_l","item","index","key","staticStyle","$event","openImg","image_urls","large","slice","indexOf","square_medium","slot","id","_s","title","directives","name","rawName","value","rankParam","isRun","expression","staticRenderFns","data","isComplete","rankType","page","tempUrlArr","isResultUndifined","scrollInterval","created","getPics","activated","setInterval","document","addEventListener","scrollevent","deactivated","clearInterval","removeEventListener","computed","filteredTags","$store","state","methods","e","target","window","open","imgUrl","checkTags","includes","tags","i","scr","documentElement","scrollTop","body","clientHeight","scrHeight","component"],"mappings":"gHAAA,yBAAgiB,EAAG,G,oECAniB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,gBAAgB,CAACG,MAAM,CAAC,gBAAgB,MAAM,eAAe,QAAQ,KAAO,SAASC,GAAG,CAAC,OAASR,EAAIS,eAAe,CAACL,EAAG,iBAAiB,CAACG,MAAM,CAAC,MAAQ,QAAQ,CAACP,EAAIU,GAAG,UAAUN,EAAG,iBAAiB,CAACG,MAAM,CAAC,MAAQ,SAAS,CAACP,EAAIU,GAAG,UAAUN,EAAG,iBAAiB,CAACG,MAAM,CAAC,MAAQ,UAAU,CAACP,EAAIU,GAAG,WAAW,IAAI,GAAGN,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,QAAQ,CAACO,IAAI,WAAWX,EAAIY,GAAIZ,EAAc,YAAE,SAASa,EAAKC,GAAO,OAAOV,EAAG,QAAQ,CAACW,IAAI,OAASD,EAAMP,MAAM,CAAC,KAAO,IAAI,CAACH,EAAG,SAAS,CAACY,YAAY,CAAC,MAAQ,MAAM,gBAAgB,QAAQT,MAAM,CAAC,UAAY,GAAG,UAAY,CAAE,cAAe,WAAYC,GAAG,CAAC,MAAQ,SAASS,GAAQjB,EAAIkB,QAC1xB,yCACEL,EAAKM,WAAWC,MAAMC,MACpBR,EAAKM,WAAWC,MAAME,QAAQ,YAE/B,CAAClB,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,QAAQ,IAAM,yCAC1CM,EAAKM,WAAWI,cAAcF,MAC5BR,EAAKM,WAAWI,cAAcD,QAAQ,SACrCE,KAAK,UAAUpB,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQM,EAAKY,KAAK,CAACrB,EAAG,WAAW,CAACoB,KAAK,eAAe,CAACxB,EAAIU,GAAGV,EAAI0B,GAAGb,EAAKc,WAAW,IAAI,IAAI,MAAK,GAAGvB,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,OAAO,CAACwB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,OAAQ/B,EAAIgC,UAAUC,MAAOC,WAAW,sBAAsB,CAAClC,EAAIU,GAAG,cAAcN,EAAG,OAAO,CAACwB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAO/B,EAAqB,kBAAEkC,WAAW,uBAAuB,CAAClC,EAAIU,GAAG,sBAAsB,MAC5dyB,EAAkB,G,+DCqDtB,GACEN,KAAM,OACNO,KAFF,WAGI,MAAO,CAELJ,UAAW,CACTK,YAAY,EACZJ,OAAO,GAETK,SAAU,MACVC,KAAM,EACNC,WAAY,GACZC,mBAAmB,EACnBC,eAAgB,KAGpBC,QAhBF,WAiBI1C,KAAK2C,WAEPC,UAnBF,WAmBA,WAEI5C,KAAKyC,eAAiBI,aAAY,WAChC,EAAN,gBACA,KACIC,SAASC,iBAAiB,SAAU/C,KAAKgD,cAE3CC,YA1BF,WA4BIC,cAAclD,KAAKyC,gBACnBK,SAASK,oBAAoB,SAAUnD,KAAKgD,cAE9CI,SAAU,CAERC,aAFJ,WAGM,OAAOrD,KAAKsD,OAAOC,MAAMF,eAG7BG,QAAS,CACPhD,aADJ,SACA,GACMR,KAAKuC,WAAa,GAClBvC,KAAKsC,KAAO,EACZtC,KAAK+B,UAAUK,YAAa,EAC5BpC,KAAK+B,UAAUC,OAAQ,EACvBhC,KAAKwC,mBAAoB,EACzBxC,KAAKqC,SAAWoB,EAAEC,OAAO5B,MACzB9B,KAAK2C,WAGPA,QAXJ,WAWA,WACM,IAAI3C,KAAK+B,UAAUK,YAAepC,KAAK+B,UAAUC,MAAjD,CAIAhC,KAAK+B,UAAUC,OAAQ,EACvB,IAAN,EACA,iDAEA,cACA,SACA,UACA,OACM,EAAN,SACA,kBAEQ,GAAR,aAIU,OAHA,EAAV,OACU,EAAV,wBACU,EAAV,UAIA,0BACU,EAAV,qBACU,EAAV,yBAEU,EAAV,qBAIQ,IAAR,oCACA,qCAIU,EAAV,mCAGQ,EAAR,UAEA,mBACQ,QAAR,UAEA,oBAEQ,YAAR,WACU,EAAV,qBACA,UAIIf,QA/DJ,SA+DA,GACM0C,OAAOC,KAAKC,EAAQ,WAGtBC,UAnEJ,SAmEA,GACM,IAAK,IAAX,mBACQ,GAAI9D,KAAKqD,aAAaU,SAASC,EAAKC,GAAGrC,MACrC,OAAO,EAGX,OAAO,GAGToB,YA5EJ,WA6EM,IAAIkB,EAAMpB,SAASqB,gBAAgBC,WAAatB,SAASuB,KAAKD,UAC1DE,EAAexB,SAASqB,gBAAgBG,aACxCC,EACV,kEACUL,EAAMI,EAAeC,EAAY,KACnCvE,KAAK2C,aCrLiU,I,wBCQ1U6B,EAAY,eACd,EACA1E,EACAoC,GACA,EACA,KACA,KACA,MAIa,aAAAsC,E","file":"static/js/chunk-323bc13d.85f8a087.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@6.2.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Rank.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@6.2.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Rank.vue?vue&type=style&index=0&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"rank\"},[_c('div',{staticClass:\"rank-radios\"},[_c('a-radio-group',{attrs:{\"default-value\":\"day\",\"button-style\":\"solid\",\"size\":\"large\"},on:{\"change\":_vm.handleSubmit}},[_c('a-radio-button',{attrs:{\"value\":\"day\"}},[_vm._v(\" 日榜 \")]),_c('a-radio-button',{attrs:{\"value\":\"week\"}},[_vm._v(\" 周榜 \")]),_c('a-radio-button',{attrs:{\"value\":\"month\"}},[_vm._v(\" 月榜 \")])],1)],1),_c('div',{staticClass:\"rank-main\"},[_c('a-row',{ref:\"picsRow\"},_vm._l((_vm.tempUrlArr),function(item,index){return _c('a-col',{key:'card' + index,attrs:{\"span\":4}},[_c('a-card',{staticStyle:{\"width\":\"90%\",\"margin-bottom\":\"30px\"},attrs:{\"hoverable\":\"\",\"bodyStyle\":{ 'white-space': 'nowrap' }},on:{\"click\":function($event){_vm.openImg(\n              'https://pximg.pixiv-viewer.workers.dev' +\n                item.image_urls.large.slice(\n                  item.image_urls.large.indexOf('/c/')\n                )\n            )}}},[_c('img',{attrs:{\"slot\":\"cover\",\"src\":'https://pximg.pixiv-viewer.workers.dev' +\n              item.image_urls.square_medium.slice(\n                item.image_urls.square_medium.indexOf('/c/')\n              )},slot:\"cover\"}),_c('a-card-meta',{attrs:{\"title\":item.id}},[_c('template',{slot:\"description\"},[_vm._v(_vm._s(item.title))])],2)],1)],1)}),1),_c('div',{staticClass:\"search-tips\"},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.rankParam.isRun),expression:\"!rankParam.isRun\"}]},[_vm._v(\"正在加载0v0~\")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isResultUndifined),expression:\"isResultUndifined\"}]},[_vm._v(\"再怎么搜也没有了辣>_<~\")])])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"rank\">\r\n    <div class=\"rank-radios\">\r\n      <a-radio-group\r\n        default-value=\"day\"\r\n        button-style=\"solid\"\r\n        size=\"large\"\r\n        @change=\"handleSubmit\"\r\n      >\r\n        <a-radio-button value=\"day\"> 日榜 </a-radio-button>\r\n        <a-radio-button value=\"week\"> 周榜 </a-radio-button>\r\n        <a-radio-button value=\"month\"> 月榜 </a-radio-button>\r\n      </a-radio-group>\r\n    </div>\r\n    <div class=\"rank-main\">\r\n      <a-row ref=\"picsRow\">\r\n        <a-col\r\n          :span=\"4\"\r\n          v-for=\"(item, index) in tempUrlArr\"\r\n          :key=\"'card' + index\"\r\n        >\r\n          <a-card\r\n            hoverable\r\n            style=\"width: 90%; margin-bottom: 30px\"\r\n            @click=\"\r\n              openImg(\r\n                'https://pximg.pixiv-viewer.workers.dev' +\r\n                  item.image_urls.large.slice(\r\n                    item.image_urls.large.indexOf('/c/')\r\n                  )\r\n              )\r\n            \"\r\n            :bodyStyle=\"{ 'white-space': 'nowrap' }\"\r\n          >\r\n            <img\r\n              slot=\"cover\"\r\n              :src=\"\r\n                'https://pximg.pixiv-viewer.workers.dev' +\r\n                item.image_urls.square_medium.slice(\r\n                  item.image_urls.square_medium.indexOf('/c/')\r\n                )\r\n              \"\r\n            />\r\n            <a-card-meta :title=\"item.id\">\r\n              <template slot=\"description\">{{ item.title }}</template>\r\n            </a-card-meta>\r\n          </a-card>\r\n        </a-col>\r\n      </a-row>\r\n      <div class=\"search-tips\">\r\n        <!-- 正在搜索时 -->\r\n        <span v-show=\"!rankParam.isRun\">正在加载0v0~</span>\r\n        <!-- 无搜索结果时 -->\r\n        <span v-show=\"isResultUndifined\">再怎么搜也没有了辣&gt;_&lt;~</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"Rank\",\r\n  data() {\r\n    return {\r\n      // 输入框内容\r\n      rankParam: {\r\n        isComplete: false, // 搜索结果是否全部展示\r\n        isRun: true, // 当前是否可搜索\r\n      },\r\n      rankType: \"day\", // 排行类型\r\n      page: 1, // 下一页的页码\r\n      tempUrlArr: [], // 小图url数组\r\n      isResultUndifined: false, // 查询返回结果是否为空\r\n      scrollInterval: {}, // 滚轮循环的存储\r\n    };\r\n  },\r\n  created() {\r\n    this.getPics();\r\n  },\r\n  activated() {\r\n    // 切入时绑定滚轮事件、设置定时器监听是否到底部\r\n    this.scrollInterval = setInterval(() => {\r\n      this.scrollevent();\r\n    }, 5000);\r\n    document.addEventListener(\"scroll\", this.scrollevent);\r\n  },\r\n  deactivated() {\r\n    // 切出时解绑滚轮事件、取消定时器\r\n    clearInterval(this.scrollInterval);\r\n    document.removeEventListener(\"scroll\", this.scrollevent);\r\n  },\r\n  computed: {\r\n    // vuex中获取要过滤的tags数组\r\n    filteredTags() {\r\n      return this.$store.state.filteredTags;\r\n    },\r\n  },\r\n  methods: {\r\n    handleSubmit(e) {\r\n      this.tempUrlArr = [];\r\n      this.page = 1;\r\n      this.rankParam.isComplete = false;\r\n      this.rankParam.isRun = true;\r\n      this.isResultUndifined = false;\r\n      this.rankType = e.target.value;\r\n      this.getPics();\r\n    },\r\n    // 向后台发送请求并将结果处理后存入tempUrlArr\r\n    getPics() {\r\n      if (this.rankParam.isComplete || !this.rankParam.isRun) {\r\n        return;\r\n      }\r\n      // 去后台搜索前对搜索功能进行封闭，以免重复触发搜索出bug\r\n      this.rankParam.isRun = false;\r\n      let tempUrl =\r\n        \"https://api.imjad.cn/pixiv/v2/?type=rank\" +\r\n        \"&mode=\" +\r\n        this.rankType +\r\n        \"&page=\" +\r\n        this.page;\r\n      let _t = this;\r\n      Axios.get(tempUrl)\r\n        .then((res) => {\r\n          // 当成功返回未知的错误信息，将page加1，打开搜索功能再次尝试\r\n          if (res.data.error) {\r\n            _t.page++;\r\n            _t.rankParam.isRun = true;\r\n            _t.getPics();\r\n            return;\r\n          }\r\n          // 当返回结果为空时给出页面提示，并打开搜索已完成开关，避免重复发送搜索请求\r\n          if (res.data.illusts.length == 0) {\r\n            _t.isResultUndifined = true;\r\n            _t.rankParam.isComplete = true;\r\n          } else {\r\n            _t.isResultUndifined = false;\r\n          }\r\n\r\n          // 根据tempUrlArr循环过滤作品tags\r\n          for (let i = 0; i < res.data.illusts.length; i++) {\r\n            if (this.checkTags(res.data.illusts[i].tags)) {\r\n              continue;\r\n            }\r\n            // 向临时数组中增加过滤后的作品\r\n            _t.tempUrlArr.push(res.data.illusts[i]);\r\n          }\r\n          // 请求成功后增加当前页码\r\n          _t.page++;\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        })\r\n        .finally(() => {\r\n          // 请求结束1秒后打开搜索功能\r\n          setTimeout(() => {\r\n            _t.rankParam.isRun = true;\r\n          }, 1000);\r\n        });\r\n    },\r\n    // 新窗口打开图片\r\n    openImg(imgUrl) {\r\n      window.open(imgUrl, \"_blank\");\r\n    },\r\n    // 检查tags对象数组中是否包含需要过滤的tag，若是返回true\r\n    checkTags(tags) {\r\n      for (let i = 0; i < tags.length; i++) {\r\n        if (this.filteredTags.includes(tags[i].name)) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    },\r\n    // 滚轮滚动检测是否到底\r\n    scrollevent() {\r\n      var scr = document.documentElement.scrollTop || document.body.scrollTop; // 向上滚动的那一部分高度\r\n      var clientHeight = document.documentElement.clientHeight; // 屏幕高度也就是当前设备静态下你所看到的视觉高度\r\n      var scrHeight =\r\n        document.documentElement.scrollHeight || document.body.scrollHeight; // 整个网页的实际高度，兼容Pc端\r\n      if (scr + clientHeight > scrHeight - 150) {\r\n        this.getPics();\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.rank {\r\n  .rank-radios {\r\n    height: 70px;\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .ant-radio-button-wrapper {\r\n      padding: 0 20px;\r\n    }\r\n  }\r\n\r\n  .rank-main {\r\n    background-color: #fff;\r\n    padding: 24px;\r\n    min-height: 280px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n\r\n  .ant-card {\r\n    margin: 0 auto;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Rank.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Rank.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Rank.vue?vue&type=template&id=b61d04d4&\"\nimport script from \"./Rank.vue?vue&type=script&lang=js&\"\nexport * from \"./Rank.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Rank.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}